\appendix

\section{Butcher Tableau for IMEX Schemes}
\label{app:butcherTables}

For easy reference, we include the Butcher tableau for the IMEX schemes considered in this paper, which can be written in the standard double Butcher tableau
\begin{equation}
  \begin{array}{c | c}
    \tilde{\vect{c}} & \tilde{A} \\
    \hline
    & \tilde{\vect{w}}^{T}
  \end{array}
  \qquad
  \begin{array}{c | c}
    \vect{c} & A \\
    \hline
    \alpha & \vect{w}^{T}
  \end{array},
\end{equation}
where the \emph{explicit tableau} (left; components adorned with a tilde) represent the explicit part of the IMEX scheme, and the \emph{implicit tableau} (right; unadorned components) represent the implicit part of the IMEX scheme.  
For $s$ stages, $\tilde{A}=(\tilde{a}_{ij})$, $\tilde{a}_{ij}=0$ for $j\ge i$, and $A=(a_{ij})$, $a_{ij}=0$ for $j>i$, are $s\times s$ matrices, and $\tilde{\vect{w}}=(\tilde{w}_{1},\ldots,\tilde{w}_{s})^{T}$ and $\vect{w}=(w_{1},\ldots,w_{s})^{T}$.  
The vectors $\tilde{\vect{c}}=(\tilde{c}_{1},\ldots,\tilde{c}_{s})^{T}$ and $\vect{c}=(c_{1},\ldots,c_{s})^{T}$, used for non autonomous systems, satisfy $\tilde{c}_{i}=\sum_{j=1}^{i-1}\tilde{a}_{ij}$ and $c_{i}=\sum_{j=1}^{i}a_{ij}$.  
For the implicit tableau, we have included the scalar $\alpha$, used for the correction step in Eq.~\eqref{eq:imexCorrection}.  

\paragraph{IMEX PA2}

A second-order accurate, positivity-preserving IMEX scheme of type $A$ (the matrix $A$ is invertible) was given in \cite{hu_etal_2017}.  
We refer to this scheme as IMEX PA2.  
For this scheme, the non-zero components of $\tilde{A}$ and $A$ are given by
\begin{align}
  \tilde{a}_{21} &= 0.7369502715, \nonumber \\
  \tilde{a}_{31} &= 0.3215281691, \quad \tilde{a}_{32} = 0.6784718309, \nonumber \\
  a_{11} &= 0.6286351712, \nonumber \\
  a_{21} &= 0.2431004655, \quad a_{22} = 0.1959392570, \nonumber \\
  a_{31} &= 0.4803651051, \quad a_{32} = 0.0746432814, \quad a_{33} = 0.4449916135. \nonumber
\end{align}
The coefficient in the correction step is $\alpha = 0.2797373792$ and the CFL constant is $c_{sch} = 0.5247457524$.
This scheme is globally stiffly accurate (GSA), so that $\tilde{w}_{i}=\tilde{a}_{3i}$ and $w_{i}=a_{3i}$ for $i\le3$.

\paragraph{IMEX PA2+}

We have found another second-order accurate, positivity-preserving IMEX scheme of type $A$, which we refer to as IMEX PA2+.  
This scheme allows for has a larger $c_{sch}$ than IMEX PA2 (i.e., a larger time step while still maintaining positivity).  
The scheme chosen from random sampling of the IMEX parameter space, and was the scheme with the largest $c_{sch}$ that satisfied both the order conditions for second order accuracy and possessed the positivity-preserving property.  
For IMEX PA2+, ($c_{sch} = 0.895041066934$). 
The non-zero components of $\tilde{A}$ and $A$ are given by
\begin{align}
  \tilde{a}_{21} &= 0.909090909090909, \nonumber \\
  \tilde{a}_{31} &= 0.450000000000000, \quad \tilde{a}_{32} = 0.550000000000000, \nonumber \\
  a_{11} &= 0.521932391842510, \nonumber \\
  a_{21} &= 0.479820781424967, \quad a_{22} = 0.002234534340252, \nonumber \\
  a_{31} &= 0.499900000000000, \quad a_{32} = 0.001100000000000, \quad a_{33} = 0.499000000000000. \nonumber
\end{align}
The coefficient in the correction step is $\alpha = 0.260444263529413$.  
This scheme is also GSA; $\tilde{w}_{i}=\tilde{a}_{3i}$ and $w_{i}=a_{3i}$ for $i\le3$.

\paragraph{IMEX PC2}

Another positivity-preserving IMEX scheme was given in \cite{mcclarren_etal_2008} (referred to as a semi-implicit predictor-corrector method in \cite{mcclarren_etal_2008}).  
This scheme can be written in the double Butcher tableau form, and we refer to this scheme as IMEX PC2.  
The non-zero components of $\tilde{A}$ and $A$ are given by
\begin{align}
  \tilde{a}_{21} &= 0.5, \quad \tilde{a}_{32} = 1, \nonumber \\
  a_{22} &= 0.5, \quad a_{33} = 1.0. \nonumber
\end{align}
And $\tilde{w}_{i}=\tilde{a}_{3i} = w_{i}=a_{3i}$ for $i\le3$.

\paragraph{IMEX PARSD}

We have found a second-order accurate in the streaming limit, diffusion accurate, positivity-preserving IMEX scheme of type $ARS$, which we refer to as IMEX PARSD.  
This scheme allows for has a $c_{sch}= 1 - 2\epsilon$ which can arbitrary close to 1 by setting $\epsilon$ a arbitrary small positive value.
Here we give an example by setting $\epsilon=0.1$.
\begin{align}
  \tilde{a}_{21} & = 1.0, \nonumber \\
  \tilde{a}_{31} & = 0.5, \quad \tilde{a}_{32} = 0.5, \nonumber \\
  a_{22} & = 1.0, \nonumber \\
  a_{32} & = 0.4 \,( = 0.5 - \epsilon\,), \quad a_{33} = 0.6 \,( = 0.5 + \epsilon\,). \nonumber
\end{align} 
This scheme is also GSA and needs only two compute for implicit terms each time-step.

\paragraph{IMEX RKCB2}

We compare the performance of the positivity-preserving IMEX schemes with two other, non-positive, schemes.  
The first one is the second-order accurate IMEX scheme given in \cite{cavaglieriBewley2015}.  
We refer to this scheme as IMEX RKCB2.  
The non-zero components of $\tilde{A}$ and $A$ are given by
\begin{align}
  \tilde{a}_{21} &= 2/5, \quad \tilde{a}_{32} = 1, \nonumber \\
  a_{22} &= 2/5, \nonumber \\
  a_{32} &= 5/6, \quad a_{33} = 1/6. \nonumber
\end{align}
And $w_{i} = a_{3i} = \tilde{w}_{i}$ for stiff accuracy.

\paragraph{IMEX SSP2332}

The second scheme we use for comparison is the second-order accurate IMEX scheme given in \cite{pareschiRusso_2005}.  
We refer to this scheme as IMEX SSP2332.  
The non-zero components of $\tilde{A}$ and $A$ are given by
\begin{align}
  \tilde{a}_{21} &= 1/2, \nonumber \\
  \tilde{a}_{31} &= 1/2, \quad \tilde{a}_{32} = 1/2, \nonumber \\
  a_{11} &= 1/4, \nonumber \\
  a_{22} &= 1/4, \nonumber \\
  a_{31} &= 1/3, \quad a_{32} = 1/3, \quad a_{33} = 1/3. \nonumber
\end{align}
And $w_{i} = a_{3i} = \tilde{w}_{i}$ for stiff accuracy.

\paragraph{SSPRK2 and SSPRK3}

To compare the performance of the IMEX schemes in the streaming limit (no collisions), we also compute results with explicit strong stability-preserving Runge-Kutta methods \cite{gottlieb_etal_2001}.  
(All elements of the implicit Butcher tableau are zero.)  
The optimal second-order accurate, strong-stability-preserving Runge-Kutta scheme (SSPRK2) has the following non-zero components
\begin{align}
  \tilde{a}_{21} &= 1, \nonumber \\ 
  \tilde{w}_{1}  &= 1/2, \quad \tilde{w}_{2} = 1/2. \nonumber 
\end{align}
The optimal third-order accurate, strong-stability-preserving Runge-Kutta scheme (SSPRK3) has the following non-zero components
\begin{align}
  \tilde{a}_{21} &= 1, \nonumber \\
  \tilde{a}_{31} &= 1/4, \quad \tilde{a}_{32} = 1/4, \nonumber \\
  \tilde{w}_{1} &= 1/6, \quad \tilde{w}_{2} = 1/6, \quad \tilde{w}_{3} =2/3. \nonumber
\end{align}

\newpage 
\section{Construction of PARSD}

It can be shown that no 2-stage positivity-preserving IMEX exist \cite{hu_etal_2017}.
Hence we considered 3-stage IMEX scheme.
There are two kinds of implicit DIRK scheme, Type A and Type ARS.
Here we discuss the simpler case, Type ARS, first.
The Butcher tableau for ARS type IMEX scheme is
\begin{equation}
  \begin{array}{c | c c c}
  	         0           & 0                    & 0                    & 0                    \\
  	\tilde{c}_{2} & \tilde{a}_{21}       & 0                    & 0                    \\
  	\tilde{c}_{3} & \tilde{a}_{31}       & \tilde{a}_{32}       & 0                    \\ \hline
  	                     & \tilde{w}_{1} & \tilde{w}_{2} & \tilde{w}_{3}
  \end{array}
  \qquad
  \begin{array}{c | c c c}
  	     0       & 0            & 0            & 0            \\
  	c_{2} & 0            & a_{22}       & 0            \\
  	c_{3} & 0            & a_{32}       & a_{33}       \\ \hline
  	             & w_{1} & w_{2} & w_{3}
  \end{array}.
\end{equation}
The properties a desired IMEX scheme should have are: 2nd-order accurate in the streaming, globally stiffly accurate, positivity-preserving, diffusion accurate and an affordable time-step restriction.
Then the problem that find such a scheme can be rewritten as an optimization problem:\\
Find $(\tilde{a}_{21}, \tilde{a}_{31}, \tilde{a}_{32}, \tilde{w}_{1}, \tilde{w}_{2}, \tilde{w}_{3}, a_{22}, a_{32}, a_{33}, w_{1}, w_{2}, w_{3})$ such that
\begin{align*}
\text{maximize} ~ c_{sch} = &\min \{ \dfrac{c_{20}}{\tilde{c}_{20}}, \dfrac{c_{30}}{\tilde{c}_{30}}, \dfrac{c_{32}}{\tilde{c}_{32}}\}\\
 \text{under these constraints:} \qquad & \\
 \text{(GSA)} \qquad\ &\tilde{w}_{i} = \tilde{a}_{3i}, \quad w_{i} = a_{3i},\\
 \text{(2nd-order accuracy)} \qquad\ &\sum_{i=1}^{3}  \tilde{w}_{i} = 1, \quad \sum_{i=1}^{3}  \tilde{w}_{i}\tilde{c}_{i} = 1/2, \\
 \text{(positivity-preserving)} \qquad & a_{ii} > 0, c_{i0} \geq 0, \tilde{c}_{i0} \geq 0 ~\text{for} ~ i = 2,3 \\
 & c_{32} \geq 0, \tilde{c}_{32} \geq 0, \\
 \text{(diffusion accurate)} \qquad & e^{T}_iA^{-1}\tilde{A}e = 1, ~\text{for} ~ i = 2,3, \\
 \text{(affordable)} \qquad & c_{sch} > 0.
\end{align*}
This problem can be simplified as:
\begin{equation}
  \begin{array}{c | c c c}
  	     0       & 0            & 0 & 0 \\
  	\frac{1}{2x} & \frac{1}{2x} & 0 & 0 \\
  	     1       & 1-x          & x & 0 \\ \hline
  	             & 1-x          & x & 0
  \end{array}
  \qquad
  \begin{array}{c | c c c}
  	     0       & 0 & 0            & 0 \\
  	\frac{1}{2x} & 0 & \frac{1}{2x} & 0 \\
  	     1       & 0 & 1-y          & y \\ \hline
  	             & 0 & 1-y          & y
  \end{array}.
\end{equation}
Find $(x,y)$ such that
\begin{align*}
\text{maximize} ~ c_{sch} = &\min \{ 2x, \dfrac{1-2x(1-y)}{y-x}, 2(1-y)\}\\
 \text{under these constraints:} \qquad & x > 0, ~ 1 \geq y > 0, \\
 & x \leq y, ~\dfrac{1}{2x} \geq 1-y.
\end{align*}
It can be shown that the solution is $x=\frac{1}{2}$, $y=\frac{1}{2} + \epsilon$ with $\epsilon \rightarrow 0$ and $c_{sch} = 1 - 2\epsilon$.
And the PARSD scheme follows.